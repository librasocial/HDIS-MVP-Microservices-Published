{% extends 'access_frontend/base.html' %}
{% load static %}


{%block content%}

<!-- Tabs -->
<div class="container-fluid" style="margin-top:100px">
  {%block messages%}
  {% if messages %}
  {% for message in messages %}
  <div class="row alert-danger text-center" style="padding:20px">{{message}}</div>
  {% endfor %}
  {%endif%}
  {% endblock %}
<!-- Order and issue -->
<div class="row" >
<div class="col-sm" id="profile_column">
</div>
   <div class="col-sm" id="profile_column">
     <div id="inner_column" class="alert-success">
       <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Case Details
     </div>
     <div id="inner_column">
       <table class="table table-hover">
         <tr>
           <td>Case ID</td>
           <td>{{encounter_details.encounter.encounterID}}</td>
         </tr>
         <tr>
           <td>Patient Name</td>
           <td>{{encounter_details.patient.PatientName}}</td>
         </tr>
         <tr>
          <td>Patient Date of Birth</td>
          <td>{{encounter_details.patient.PatientDOB}}</td>
        </tr>
        <tr>
         <td>Patient Age (years,months,days)</td>
         <td>{{encounter_details.patient.PatientAge}}</td>
       </tr>
        <tr>
         <td>Patient Gender</td>
         <td>{{encounter_details.patient.PatientGender}}</td>
        </tr>
      </table>
     </div>


     <div id="inner_column" class="alert-success">
       <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Files Shared by Patient
     </div>
     <div id="inner_column">
       {%if encounter_details.encounter_files%}
       {%for files in encounter_details.encounter_files%}
       <a href={{files.url}} target="_blank">
          <b>File {{forloop.counter}} | </b></a>
       {%endfor%}
       {%else%}
       No files shared by the patient
       {%endif%}
     </div>
   </div>

    <div class="col-sm" id="profile_column">
    </div>
   </div>

<div class="row" >
    <div class="col-sm" id="profile_column">
    </div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success">
        Initiate Phone Call
      </div>
      <div id="inner_column">
        <form class="form" action="{% url "opd_consultation" %}" method='post' onsubmit="submitForm()">
          {% csrf_token %}
        <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
          <input type="hidden" class="form-control" id="patient_number" name="patient_number" value={{encounter_details.patient_details.patientMobileNumber}} style="display:none">
          <input type="hidden" class="form-control" id="request_id" name="request_id" value={{encounter_details.order_details.encounterId}} style="display:none">
          {%if clicked == 1%}
          <button disabled type="submit" class="btn btn-success btn-block has-spinner" name='audio_call' id='audio_call' value="audio_call" style="margin:0px 5px 5px 0px">
          <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Click to call</button>
          {%else%}
          <button type="submit" class="btn btn-success btn-block has-spinner" name='audio_call' id='audio_call' value="audio_call" style="margin:0px 5px 5px 0px">
          <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Click to call</button>
          {%endif%}
        </form>
      </div>
      <div id="inner_column">
        <form class="form" action="{% url "opd_consultation" %}" method='post' onsubmit="submitForm()">
          {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
          <select class="form-control" id="reschedule_reason" placeholder="Reason for reschedule" name="reschedule_reason" style="margin:0px 5px 5px 0px" required>
            <option>1:User did not answer</option>
            <option>2:User mobile switched off</option>
            <option>3:User asked to call back later</option>
            <option>4:User not able to understand doctor</option>
            <option>5:Mobile number incorrect</option>
            <option>6:Patient unable to share details</option>
            <option>7:Patient asked to cancel the consultation</option>
            <option>8:Needs physical examination</option>
          </select>
          <input type="hidden" class="form-control" id="order_id" name="order_id" value='{{encounter_details.order_details.encounterId}}' style="display:none">
          <button type="submit" class="btn btn-warning btn-block has-spinner" name='update_status' id='update_status' value="" style="margin:0px 5px 5px 0px">
          <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Case Status</button>
        </form>
      </div>
    </div>
    <div class="col-sm" id="profile_column">
    </div>
</div>
<div class="row" >
    <div class="col-sm" id="profile_column">
    </div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success">
        Initiate Video Call
      </div>
      <div id="inner_column">
        <form class="form" action="{% url "opd_consultation" %}" method='post' onsubmit="submitForm()">
        {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
        <input type="hidden" class="form-control" id="request_id" name="request_id" value={{encounter_details.order_details.encounterId}} style="display:none">
        <button type="submit" class="btn btn-success btn-block has-spinner" name='video_call' id='video_call' value="Start Video Call" style="margin:0px 20px 10px 0px">
        <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Start Video Call</button>
        </form>
      </div>
      {%if vc == 1%}
      <div id="inner_column">
        <div class="row" id="meet">
          <div class="col-sm">
            <iframe src="{{room_url}}" allow="camera; microphone; fullscreen; display-capture" width="350" height="500"></iframe>
          </div>
        </div>
      </div>
      {%endif%}
    </div>
    <div class="col-sm" id="profile_column">
    </div>
</div>
<div class="row" >
    <div class="col-sm" id="profile_column">
    </div>
      {%if encounter_details.new_file_detials%}
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Files Created During Encounter
      </div>
      <div id="inner_column">
        <table class="table table-hover">
        {%for files in encounter_details.new_file_detials%}
        <tr>
            <td>
                <a href={{files.url}} target="_blank">File {{forloop.counter}}</a>
            </td>
            <td>
                <form class="form" action="{% url "opd_consultation" %}" method='post' onsubmit="submitForm()">
                  {% csrf_token %}
                    <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
                  <input type="hidden" name='file_id' value="{{files.id}}" >
                  <input type="hidden" name='order_id' value="{{encounter_details.order_details.encounterId}}" >
                  <button type="submit" class="btn btn-link btn-sm has-spinner" name='delete' id='delete' value="Delete" >
                  <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Delete</button>
                </form>
            </td>
        </tr>
        {%endfor%}
        </table>
      </div>
      <form class="form" action="{% url "opd_consultation" %}" method='post' onsubmit="submitForm()">
        {% csrf_token %}
      <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
        <input type="hidden" class="form-control" id="request_id" name="request_id" value={{encounter_details.order_details.encounterId}} style="display:none">
        {%if clicked == 1%}
        <button disabled type="submit" class="btn btn-success btn-block has-spinner" name='upload_details' id='upload_details' value="" style="margin:0px 5px 5px 0px">
        <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Upload details</button>
        {%else%}
        <button type="submit" class="btn btn-success btn-block has-spinner" name='upload_details' id='upload_details' value="" style="margin:0px 5px 5px 0px">
        <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Upload details</button>
        {%endif%}
      </form>
      {%endif%}
    </div>
    <div class="col-sm" id="profile_column">
    </div>
</div>
<div class="row" >
    <div class="col-sm" id="profile_column">
    </div>
    <div class="col-sm" id="profile_column">
      <form class="form" action="{% url "opd_consultation" %}" method='post' onsubmit="submitForm()">
      {% csrf_token %}
          <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
      <div id="inner_column" class="alert-success">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Patient Vitals
      </div>
      {% if encounter_details.vitalSigns %}
      <div id="inner_column">
      {% for vitals in encounter_details.vitalSigns %}
          Objective Documented on : {{ vitals.note_date }}
          <table class="table table-hover">
          <tr>
            <td>Vitals</td>
            <td>Value</td>
          </tr>
          {% for data in vitals.data %}
          <tr>
            <td>{{ data.vitalSignResultTypeName}}</td>
            <td>{{data.vitalSignResultValue}} {{data.vitalSignResultUnit}}</td>
          </tr>
      {% endfor %}
          </table>
      {% endfor %}
      </div>
      {% endif %}
      {% if encounter_details.vitalSigns_assessment %}
      <div id="inner_column">
      {% for vitals in encounter_details.vitalSigns_assessment %}
          Assessment Documented on : {{ vitals.note_date }}
         <table class="table table-hover">
          <tr>
            <td>Vitals</td>
            <td>Value</td>
          </tr>
          {% for data in vitals.data %}
          <tr>
            <td>{{ data.vitalSignResultTypeName}}</td>
            <td>{{data.vitalSignResultValue}} {{data.vitalSignResultUnit}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
      {% endif %}
      <div id="inner_column">
        <input type="number" step="0.01" min=0 class="form-control" id="body_height" name="body_height" value="" placeholder="Height (cm)" style="margin:0px 5px 5px 0px">
        <input type="number" step="0.01" min=0 class="form-control" id="body_weight" name="body_weight" value="" placeholder="Weight (kg)" style="margin:0px 5px 5px 0px">
        <input type="number" min=0 class="form-control" id="systolic" name="systolic" value="" placeholder="Systolic Blood Pressure" style="margin:0px 5px 5px 0px">
        <input type="number" min=0 class="form-control" id="diastolic" name="diastolic" value="" placeholder="Diastolic Blood Pressure" style="margin:0px 5px 5px 0px">
        <input type="number" step="0.01" min=0 class="form-control" id="body_temperature" name="body_temperature" value="" placeholder="Temperature (F)" style="margin:0px 5px 5px 0px">
        <input type="number" min=0 class="form-control" id="heart_rate" name="heart_rate" value="" placeholder="Heart Rate" style="margin:0px 5px 5px 0px">
        <input type="number" step="0.01" min=0 class="form-control" id="oxygen_saturation" name="oxygen_saturation" value="" placeholder="Oxygen Saturation" style="margin:0px 5px 5px 0px">
      </div>

        <button type="submit" class="btn btn-success btn-block has-spinner" name='vitalSigns'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Add Vitals</button>
      </form>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>
<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success" style="margin-top:10px">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Chief Complaints
      </div>
    {% if encounter_details.chiefComplaints %}
      <div id="inner_column">
      {% for complaints in encounter_details.chiefComplaints %}
      Subjective Documented on : {{ complaints.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Chief Complaint</td>
            <td>Body Site</td>
              <td>Since When</td>
          </tr>
      {% for data in complaints.data %}
          <tr>
            <td>{{ data.chiefComplaintName}}</td>
              <td>{{ data.chiefComplaintBodySite}}</td>
            <td>{{data.chiefComplaintDuration}} {{data.chiefComplaintDurationUnit}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      <div id="inner_column">
        <div class="row form-inline" id='chiefComplaints'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            // jQuery
            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButton').click(function() {
                  event.preventDefault();
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                dynamicDiv.append($('<input>').attr('type', 'text').addClass('form-control dname').attr('name', 'chiefComplaintName').attr('placeholder', 'Chief Complaint').css('margin', '0px 5px 5px 0px'));
                dynamicDiv.append($('<input>').attr('type', 'text').addClass('form-control').attr('name', 'chiefComplaintBodySite').attr('placeholder', 'Body Site Effected').css('margin', '0px 0px 5px 0px').prop('required', true));
                dynamicDiv.append($('<input>').attr('type', 'text').addClass('form-control').attr('name', 'chiefComplaintDuration').attr('placeholder', 'Duration Since Complaint (in days)').css('margin', '0px 0px 5px 0px').prop('required', true));
                dynamicDiv.append($('<select>').attr('id', 'chiefComplaintDurationUnit').addClass('form-control').attr('name', 'chiefComplaintDurationUnit').css('margin', '0px 5px 5px 0px').prop('required', true)
                  .append($('<option>').text('DAYS'))
                  .append($('<option>').text('WEEKS'))
                  .append($('<option>').text('MONTHS'))
                  .append($('<option>').text('YEARS')));

                dynamicDiv.appendTo('#dynamicDivContainer');
                counter++;
              });

              // Remove button click event
              $('#removeButton').click(function() {
                  event.preventDefault();
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
              });
            });

            </script>
        <button id="addButton">+</button>
        <button id="removeButton">-</button>
        <div id="dynamicDivContainer"></div>

        <button type="submit" class="btn btn-success btn-block has-spinner" name='chiefComplaints'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Add Chief Complaints</button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>
<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success" style="margin-top:10px">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Family History
      </div>
    {% if encounter_details.familyHistory %}
      <div id="inner_column">
      {% for relation in encounter_details.familyHistory %}
      Subjective Recorded on : {{ relation.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Relationship</td>
            <td>Condition</td>
              <td>Onset & Status</td>
          </tr>
      {% for data in relation.data %}
          <tr>
            <td>{{ data.familyMemberRelationship}}</td>
              <td>{{ data.familyMemeberHealthCondition}}</td>
            <td>{{data.familyMemeberAgeAtOnset}} {{data.familyMemberHealthConditionStatus}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      <div id="inner_column">
        <div class="row form-inline" id='family_history'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
        <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                                // jQuery
                $(document).ready(function() {
                  var counter = 0;

                  // Add button click event
                  $('#addButtonFamily').click(function() {
                      event.preventDefault();
                    var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                    dynamicDiv.append($('<select>').attr('type', 'text').addClass('form-control').attr('id', 'familyMemberRelationship').attr('name', 'familyMemberRelationship').css('margin', '0px 5px 5px 0px')
                      .append($('<option>').attr('value', '').prop('disabled', true).prop('selected', true).text('Relationship'))
                      .append($('<option>').text('Mother'))
                      .append($('<option>').text('Father'))
                      .append($('<option>').text('Son'))
                      .append($('<option>').text('Daughter'))
                      .append($('<option>').text('Sister'))
                      .append($('<option>').text('Brother')));

                    dynamicDiv.append($('<input>').attr('type', 'text').addClass('form-control dname').attr('id', 'familyMemeberHealthCondition').attr('name', 'familyMemeberHealthCondition').attr('placeholder', 'Health Condition').css('margin', '0px 5px 5px 0px'));

                    dynamicDiv.append($('<select>').attr('type', 'text').addClass('form-control').attr('id', 'familyMemberHealthConditionStatus').attr('name', 'familyMemberHealthConditionStatus').css('margin', '0px 5px 5px 0px')
                      .append($('<option>').attr('value', '').prop('disabled', true).prop('selected', true).text('Condition Status'))
                      .append($('<option>').text('Active'))
                      .append($('<option>').text('Inactive'))
                      .append($('<option>').text('Resolved'))
                      .append($('<option>').text('Relapsed'))
                      .append($('<option>').text('Remitted')));

                    dynamicDiv.append($('<input>').attr('type', 'text').addClass('form-control').attr('name', 'familyMemeberAgeAtOnset').attr('placeholder', 'Condition Onset Age').css('margin', '0px 0px 5px 0px'));

                    dynamicDiv.append($('<select>').attr('type', 'text').addClass('form-control').attr('id', 'causeOfDeathKnown').attr('name', 'causeOfDeathKnown').css('margin', '0px 5px 5px 0px')
                      .append($('<option>').attr('value', '').prop('disabled', true).prop('selected', true).text('Cause Of Death Known'))
                      .append($('<option>').text('Yes'))
                      .append($('<option>').text('No')));

                    dynamicDiv.append($('<input>').attr('type', 'text').addClass('form-control').attr('name', 'familyMemeberAgeAtDeath').attr('placeholder', 'Age at Death').css('margin', '0px 0px 5px 0px'));

                    dynamicDiv.appendTo('#dynamicDivContainerFamily');
                    counter++;
                  });

                  // Remove button click event
                  $('#removeButtonFamily').click(function() {
                      event.preventDefault();
                    if (counter > 0) {
                      $('#dynamicDiv' + (counter - 1)).remove();
                      counter--;
                    }
                  });
                });

            </script>
        <button id="addButtonFamily">+</button>
        <button id="removeButtonFamily">-</button>
        <div id="dynamicDivContainerFamily"></div>
        <button type="submit" class="btn btn-success btn-block has-spinner" name='familyHistory'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Family History</button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>
<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
          <div id="inner_column" class="alert-success" style="margin-top:10px">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Existing Comorbidities 5
      </div>
    {% if encounter_details.patientComorbidities %}
      <div id="inner_column">
      {% for comorbidities in encounter_details.patientComorbidities %}
          Subjective Recorded on : {{ comorbidities.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Condition</td>
            <td>Procedure Details</td>
              <td>Onset & Status</td>
          </tr>
      {% for data in comorbidities.data %}
          <tr>
            <td>{{ data.comorbidityHealthCondition}}</td>
              <td>{{ data.procedurePerformed}} on {{ data.procedureDate }}, {{ data.patientDispositionAfterProcedure }}</td>
            <td>{{data.ageAtOnsetOfHealthCondition}} {{data.comorbidityHealthConditionStatus}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      <div id="inner_column">
        <div class="row form-inline" id='comorbidities'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
              $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonComorbidities').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                  <input type="text" class="form-control dname" id="comorbidityHealthCondition" name="comorbidityHealthCondition" value="" placeholder="Health Condition" style="margin:0px 5px 5px 0px">
                  <select type="text" class="form-control" id="comorbidityHealthConditionStatus" value="" name="comorbidityHealthConditionStatus" style="margin:0px 5px 5px 0px">
                    <option value="" disabled selected>Condition Status</option>
                    <option>Active</option>
                    <option>Inactive</option>
                    <option>Resolved</option>
                    <option>Relapsed</option>
                    <option>Remitted</option>
                  </select>
                  <input type="text" class="form-control" name="ageAtOnsetOfHealthCondition" placeholder="Condition Onset Age" style="margin:0px 0px 5px 0px">
                  <input type="text" class="form-control" name="procedurePerformed" placeholder="Procedure Performed (If Any)" style="margin:0px 0px 5px 0px">
                  <input type="text" class="form-control" name="patientDispositionAfterProcedure" placeholder="Disposition After Procedure" style="margin:0px 0px 5px 0px">
                  <div class="input-group date" id="dpk" style="margin-right:10px" data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date-autoclose="true" data-date-container="#dpk">
                    <input type="text" class="form-control" name="procedureDate" placeholder="Date of Procedure" style="margin:0px 0px 5px 0px" required>
                    <div class="input-group-addon" style="margin:0px 0px 5px 0px">
                      <span class="fa fa-calendar"></span>
                    </div>
                  </div>
                `);

                dynamicDiv.appendTo('#dynamicDivContainerComorbidities');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonComorbidities').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>
            <button id="addButtonComorbidities">+</button>
        <button id="removeButtonComorbidities">-</button>
        <div id="dynamicDivContainerComorbidities"></div>
        <button type="submit" class="btn btn-success btn-block has-spinner" name='patientComorbidities'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Patient Comorbidities</button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>
<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
          <div id="inner_column" class="alert-success" style="margin-top:10px">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Social History 11
      </div>
      {% if encounter_details.socialHistory %}
      <div id="inner_column">
      {% for social_history in encounter_details.socialHistory %}
          Subjective Recorded on : {{ social_history.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Habit</td>
            <td>Since</td>
              <td>Status</td>
          </tr>
      {% for data in social_history.data %}
          <tr>
            <td>{{ data.habitDescription}}</td>
              <td>{{ data.habitType}} since {{ data.onsetSince }}</td>
            <td>{{data.currentStatus}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      <div id="inner_column">
        <div class="row form-inline" id='socialHistory'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
        <script>
                        $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonSHistory').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                  <input type="text" class="form-control dname" id="habitDescription" name="habitDescription" value="" placeholder="Habit Description" style="margin:0px 5px 5px 0px">
                  <input type="text" class="form-control dname" id="habitType" name="habitType" value="" placeholder="Habit Type" style="margin:0px 5px 5px 0px">
                  <select type="text" class="form-control" id="currentStatus" value="" name="currentStatus" style="margin:0px 5px 5px 0px">
                    <option value="" disabled selected>Current Status</option>
                    <option>Active</option>
                    <option>Inactive</option>
                    <option>Resolved</option>
                    <option>Relapsed</option>
                    <option>Remitted</option>
                  </select>
                  <input type="text" class="form-control" name="smokingFreqency" placeholder="Frequency of smoking" style="margin:0px 0px 5px 0px" required>
                  <input type="text" class="form-control" name="alcoholIntakeFrequency" placeholder="Frequency of drinking" style="margin:0px 0px 5px 0px" required>
                  <div class="input-group date" id="dpk" style="margin-right:10px" data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date-autoclose="true" data-date-container="#dpk">
                    <input type="text" class="form-control" name="onsetSince" placeholder="Onset Since" style="margin:0px 0px 5px 0px" required>
                    <div class="input-group-addon" style="margin:0px 0px 5px 0px">
                      <span class="fa fa-calendar"></span>
                    </div>
                  </div>
                `);

                dynamicDiv.appendTo('#dynamicDivContainerSHistory');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonSHistory').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

        </script>
             <button id="addButtonSHistory">+</button>
        <button id="removeButtonSHistory">-</button>
        <div id="dynamicDivContainerSHistory"></div>

        <button type="submit" class="btn btn-success btn-block has-spinner" name='socialHistory'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Social History</button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>
<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
          <div id="inner_column" class="alert-success" style="margin-top:10px">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Complications 11
      </div>
      {% if encounter_details.complications %}
      <div id="inner_column">
      {% for complication in encounter_details.complications %}
      Subjective Recorded on : {{ complication.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Complication</td>
            <td>Details</td>
              <td>Since</td>
          </tr>
      {% for data in complication.data %}
          <tr>
            <td>{{ data.complicationName}}</td>
              <td>{{ data.complicationDescription}}</td>
            <td>{{data.complicationDate}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
    {% if encounter_details.complications_assessment %}
      <div id="inner_column">
      {% for complication in encounter_details.complications_assessment %}
      Assessment Recorded on : {{ complication.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Complication</td>
            <td>Details</td>
              <td>Since</td>
          </tr>
      {% for data in complication.data %}
          <tr>
            <td>{{ data.complicationName}}</td>
              <td>{{ data.complicationDescription}}</td>
            <td>{{data.complicationDate}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      <div id="inner_column">
        <div class="row form-inline" id='complications'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
        <script>
                        $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonComplications').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                   <input type="text" class="form-control dname" id="complicationType" name="complicationType" value="" placeholder="Complication Type" style="margin:0px 5px 5px 0px">
                  <input type="text" class="form-control" name="complicationName" placeholder="Complication Name" style="margin:0px 0px 5px 0px" required>
                  <input type="text" class="form-control" name="complicationDescription" placeholder="Complication Description" style="margin:0px 0px 5px 0px" required>
                  <div class="input-group date" id="dpk" style="margin-right:10px" data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date-autoclose="true" data-date-container="#dpk">
                    <input type="text" class="form-control" name="complicationDate" placeholder="Complication Date" style="margin:0px 0px 5px 0px" required>
                    <div class="input-group-addon" style="margin:0px 0px 5px 0px">
                      <span class="fa fa-calendar"></span>
                    </div>
                  </div>
                `);

                dynamicDiv.appendTo('#dynamicDivContainerComplications');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonComplications').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

        </script>
        <button id="addButtonComplications">+</button>
        <button id="removeButtonComplications">-</button>
        <div id="dynamicDivContainerComplications"></div>

        <button type="submit" class="btn btn-success btn-block has-spinner" name='complications'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Complications History</button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>
<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
          <div id="inner_column" class="alert-success" style="margin-top:10px">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Disability 11
      </div>
      {% if encounter_details.disability %}
      <div id="inner_column">
      {% for disabilities in encounter_details.disability %}
      Subjective Recorded on : {{ disabilities.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Disability</td>
            <td>Details</td>
              <td>Since</td>
          </tr>
      {% for data in disabilities.data %}
          <tr>
            <td>{{ data.disabilityName}}</td>
              <td>{{ data.disabilityDescription}}</td>
            <td>{{data.complicationDate}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
    {% if encounter_details.disability_assessment %}
      <div id="inner_column">
      {% for disabilities in encounter_details.disability_assessment %}
      Assessment Recorded on : {{ disabilities.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Disability</td>
            <td>Details</td>
              <td>Since</td>
          </tr>
      {% for data in disabilities.data %}
          <tr>
            <td>{{ data.disabilityName}}</td>
              <td>{{ data.disabilityDescription}}</td>
            <td>{{data.complicationDate}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      <div id="inner_column">
        <div class="row form-inline" id='disability'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonDisability').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                  <input type="text" class="form-control dname" id="disabilityType" name="disabilityType" value="" placeholder="Disability Type" style="margin:0px 5px 5px 0px">
                  <input type="text" class="form-control" name="disabilityName" placeholder="Disability Name" style="margin:0px 0px 5px 0px" required>
                  <input type="text" class="form-control" name="disabilityDescription" placeholder="Disability Description" style="margin:0px 0px 5px 0px" required>
                  <div class="input-group date" id="dpk" style="margin-right:10px" data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date-autoclose="true" data-date-container="#dpk">
                    <input type="text" class="form-control" name="disabilityDate" placeholder="Disability Date" style="margin:0px 0px 5px 0px" required>
                    <div class="input-group-addon" style="margin:0px 0px 5px 0px">
                      <span class="fa fa-calendar"></span>
                    </div>
                  </div>
                `);

                dynamicDiv.appendTo('#dynamicDivContainerDisability');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonDisability').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>
        <button id="addButtonDisability">+</button>
        <button id="removeButtonDisability">-</button>
        <div id="dynamicDivContainerDisability"></div>
        <button type="submit" class="btn btn-success btn-block has-spinner" name='disability'>
      <span class="spinner">
          <i class="fa fa-refresh fa-spin"></i>
      </span>Update Disability History
        </button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>
<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
          <div id="inner_column" class="alert-success" style="margin-top:10px">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Relapse 11
      </div>
      {% if encounter_details.relapse %}
      <div id="inner_column">
      {% for relapses in encounter_details.relapse %}
      Subjective Recorded on : {{ relapses.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Relapse</td>
            <td>Details</td>
              <td>Since</td>
          </tr>
      {% for data in relapses.data %}
          <tr>
            <td>{{ data.relapseName}}</td>
              <td>{{ data.relapseDescription}}</td>
            <td>{{data.relapseDate}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      {% if encounter_details.relapse_assessment %}
      <div id="inner_column">
      {% for relapses in encounter_details.relapse_assessment %}
      Assessment Recorded on : {{ relapses.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Relapse</td>
            <td>Details</td>
              <td>Since</td>
          </tr>
      {% for data in relapses.data %}
          <tr>
            <td>{{ data.relapseName}}</td>
              <td>{{ data.relapseDescription}}</td>
            <td>{{data.relapseDate}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      <div id="inner_column">
        <div class="row form-inline" id='complications'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonRelapse').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                  <input type="text" class="form-control dname" id="relapseType" name="relapseType" value="" placeholder="Relapse Type" style="margin:0px 5px 5px 0px">
                    <input type="text" class="form-control" name="relapseName" placeholder="Relapse Name" style="margin:0px 0px 5px 0px" required>
                    <input type="text" class="form-control" name="relapseDescription" placeholder="Relapse Description" style="margin:0px 0px 5px 0px" required>
                    <div class="input-group date" id ="dpk" style="margin-right:10px" data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date-autoclose="true" data-date-container="#dpk">
                    <input type="text" class="form-control" name="relapseDate" placeholder="Relapse Date" style="margin:0px 0px 5px 0px" required>
                    <div class="input-group-addon" style="margin:0px 0px 5px 0px">
                        <span class="fa fa-calendar"></span>
                    </div>
                    </div>
                `);

                dynamicDiv.appendTo('#dynamicDivContainerRelapse');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonRelapse').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>


        <button id="addButtonRelapse">+</button>
        <button id="removeButtonRelapse">-</button>
        <div id="dynamicDivContainerRelapse"></div>

        <button type="submit" class="btn btn-success btn-block has-spinner" name='relapse'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Relapse History
        </button>
        </form>
        </div>
        </div>
      </div>
    </div>
    <div class="col-sm" id="profile_column">
    </div>
</div>
<div class="row" >
    <div class="col-sm" id="profile_column">
    </div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success" style="margin-top:10px">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Remission 11
      </div>
      {% if encounter_details.remission %}
      <div id="inner_column">
      {% for remissions in encounter_details.remission %}
      Assessment Recorded on : {{ remissions.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Remission</td>
            <td>Details</td>
              <td>Since</td>
          </tr>
      {% for data in remissions.data %}
          <tr>
            <td>{{ data.remissionName}}</td>
              <td>{{ data.remissionDescription}}</td>
            <td>{{data.remissionDate}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
        {% endif %}
      {% if encounter_details.remission_assessment %}
      <div id="inner_column">
      {% for remissions in encounter_details.remission_assessment %}
          Assessment Recorded on : {{ remissions.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Remission</td>
            <td>Details</td>
              <td>Since</td>
          </tr>
      {% for data in remissions.data %}
          <tr>
            <td>{{ data.remissionName}}</td>
              <td>{{ data.remissionDescription}}</td>
            <td>{{data.remissionDate}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
        {% endif %}
      <div id="inner_column">
        <div class="row form-inline" id='remission'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonRemission').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                  <input type="text" class="form-control dname" id="remissionType" name="remissionType" value="" placeholder="Remission Type" style="margin:0px 5px 5px 0px">
                    <input type="text" class="form-control" name="remissionName" placeholder="Remission Name" style="margin:0px 0px 5px 0px" required>
                    <input type="text" class="form-control" name="remissionDescription" placeholder="Remission Description" style="margin:0px 0px 5px 0px" required>
                    <div class="input-group date" id ="dpk" style="margin-right:10px" data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date-autoclose="true" data-date-container="#dpk">
                    <input type="text" class="form-control" name="remissionDate" placeholder="Remission Date" style="margin:0px 0px 5px 0px" required>
                    <div class="input-group-addon" style="margin:0px 0px 5px 0px">
                        <span class="fa fa-calendar">
                        </span>
                    </div>
                    </div>
                `);

                dynamicDiv.appendTo('#dynamicDivContainerRemission');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonRemission').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>

            <button id="addButtonRemission">+</button>
        <button id="removeButtonRemission">-</button>
        <div id="dynamicDivContainerRemission"></div>

        <button type="submit" class="btn btn-success btn-block has-spinner" name='remission'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Remission History</button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>
<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
          <div id="inner_column" class="alert-success" style="margin-top:10px">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Existing Allergies 11
      </div>
      {% if encounter_details.allergy %}
      <div id="inner_column">
      {% for allergies in encounter_details.allergy %}
          Subjective Recorded on : {{ allergies.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Product</td>
            <td>Reaction</td>
              <td>Severity</td>
              <td>Status</td>
          </tr>
      {% for data in allergies.data %}
          <tr>
            <td>{{ data.allergyProduceDescription}}</td>
              <td>{{ data.allergyReactionName}} {{ data.allergyRectionDescription}}</td>
            <td>{{data.allergySeverityDescription}}</td>
          <td>{{data.allergyStatus}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      {% if encounter_details.allergy_assessment %}
      <div id="inner_column">
      {% for allergies in encounter_details.allergy_assessment %}
          Assessment Recorded on : {{ allergies.note_date }}
      {% for data in allergies.data %}
          <tr>
            <td>{{ data.allergyProduceDescription}}</td>
              <td>{{ data.allergyReactionName}} {{ data.allergyRectionDescription}}</td>
            <td>{{data.allergySeverityDescription}}</td>
          <td>{{data.allergyStatus}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      <div id="inner_column">
        <div class="row form-inline" id='allergy'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonAllergy').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                  <input type="text" class="form-control dname" id="allergyProduceDescription" name="allergyProduceDescription" value="" placeholder="Produce Description" style="margin:0px 5px 5px 0px">
                <input type="text" class="form-control" name="allergyReactionName" placeholder="Reaction Name" style="margin:0px 0px 5px 0px" required>
                <input type="text" class="form-control" name="allergyRectionDescription" placeholder="Rection Description" style="margin:0px 0px 5px 0px" required>
                <input type="text" class="form-control" name="allergySeverityDescription" placeholder="allergy Severity" style="margin:0px 0px 5px 0px" required>
                <input type="text" class="form-control" name="allergyStatus" placeholder="allergy Status" style="margin:0px 0px 5px 0px" required>
                <input type="text" class="form-control" name="allergyEventType" placeholder="Event Type" style="margin:0px 0px 5px 0px" required>
                <textarea class="form-control" rows="3" cols="50" id="allergyHistory" placeholder="allergy History Notes (Required)" name="allergyHistory" required style="margin-bottom:5px"></textarea>
                `);

                dynamicDiv.appendTo('#dynamicDivContainerAllergy');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonAllergy').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>

            <button id="addButtonAllergy">+</button>
        <button id="removeButtonAllergy">-</button>
        <div id="dynamicDivContainerAllergy"></div>

        <button type="submit" class="btn btn-success btn-block has-spinner" name='allergy'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Allergy History</button>
        </form>
        </div>
        </div>
      </div>
    </div>
    <div class="col-sm" id="profile_column">
</div>

</div>
<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success" style="margin-top:10px">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Examination Notes 11
      </div>
      {% if encounter_details.examination %}
      <div id="inner_column">
      {% for examinations in encounter_details.examination %}
          Subjective Recorded on : {{ examinations.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Examination</td>
            <td>Body Site</td>
              <td>Author Details</td>
          </tr>
      {% for data in examinations.data %}
          <tr>
            <td>{{ data.examinationType}} {{ data.examinationFinding}}</td>
              <td>{{ data.examinationSystem}} {{ data.bodySiteName}}</td>
            <td>{{ data.authorId}} {{ data.authorDateTime}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      {% if encounter_details.examination_assessment %}
      <div id="inner_column">
      {% for examinations in encounter_details.examination_assessment %}
          Assessment Recorded on : {{ examinations.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Examination</td>
            <td>Body Site</td>
              <td>Author Details</td>
          </tr>
      {% for data in examinations.data %}
          <tr>
            <td>{{ data.examinationType}} {{ data.examinationFinding}}</td>
              <td>{{ data.examinationSystem}} {{ data.bodySiteName}}</td>
            <td>{{ data.authorId}} {{ data.authorDateTime}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      <div id="inner_column">
        <div class="row form-inline" id='examination'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonExamination').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                    <input type="text" class="form-control dname" id="examinationType" name="examinationType" value="" placeholder="Examination Type" style="margin:0px 5px 5px 0px">
                    <input type="text" class="form-control" name="examinationSystem" placeholder="Body System Examined" style="margin:0px 0px 5px 0px" required>
                    <input type="text" class="form-control" name="bodySiteName" placeholder="Body Site Examined" style="margin:0px 0px 5px 0px" required>
                    <textarea class="form-control" rows="3" cols="50" id="examinationFinding" placeholder="Examination Notes (Required)" name="examinationFinding" required style="margin-bottom:5px"></textarea>
                `);

                dynamicDiv.appendTo('#dynamicDivContainerExamination');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonExamination').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>

            <button id="addButtonExamination">+</button>
        <button id="removeButtonExamination">-</button>
        <div id="dynamicDivContainerExamination"></div>

        <button type="submit" class="btn btn-success btn-block has-spinner" name='examination'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Examination Details</button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>
<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success" style="margin-top:10px">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Diagnosis Details 18
      </div>
      {% if encounter_details.diagnosis %}
      <div id="inner_column">
      {% for diagnosis in encounter_details.diagnosis %}
          Assessment Recorded on : {{ diagnosis.note_date }}
      <table class="table table-hover">
          <tr>
            <td>Examination</td>
            <td>Body Site</td>
              <td>Author Details</td>
          </tr>
      {% for data in diagnosis.data %}
          <tr>
            <td>{{ data.healthConditionName}} {{ data.healthConditionDescription}}</td>
              <td>{{ data.healthConditionStatus}}</td>
            <td>{{ data.diagnosisPriority}}</td>
          </tr>
      {% endfor %}
      </table>
      {% endfor %}
      </div>
    {% endif %}
      <div id="inner_column">
        <div class="row form-inline" id='diagnosis'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
            <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonDiasnosis').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                    <input type="text" class="form-control dname" id="healthConditionType" name="healthConditionType" value="" placeholder="health Condition Type" style="margin:0px 5px 5px 0px">
                    <input type="text" class="form-control dname" id="healthConditionName" name="healthConditionName" value="" placeholder="health Condition Name" style="margin:0px 5px 5px 0px">
                    <input type="text" class="form-control" name="healthConditionDescription" placeholder="health Condition Description" style="margin:0px 0px 5px 0px" required>
                    <input type="text" class="form-control" name="healthConditionCategory" placeholder="health Condition Category" style="margin:0px 0px 5px 0px" required>
                    <input type="text" class="form-control" name="healthConditionStatus" placeholder="health Condition Status" style="margin:0px 0px 5px 0px" required>
                    <input type="text" class="form-control" name="diagnosisPriority" placeholder="diagnosis Priority" style="margin:0px 0px 5px 0px" required>
                    <div class="input-group date" id ="dpk" style="margin-right:10px" data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date-autoclose="true" data-date-container="#dpk">
                    <input type="text" class="form-control" name="presentHealthConditionOnsetDate" placeholder="Onset Date" style="margin:0px 0px 5px 0px" required>
                    <div class="input-group-addon" style="margin:0px 0px 5px 0px">
                        <span class="fa fa-calendar">
                        </span>
                    </div>
                    </div>
                `);

                dynamicDiv.appendTo('#dynamicDivContainerDiasnosis');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonDiasnosis').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>

            <button id="addButtonDiasnosis">+</button>
        <button id="removeButtonDiasnosis">-</button>
        <div id="dynamicDivContainerDiasnosis"></div>

        <button type="submit" class="btn btn-success btn-block has-spinner" name='diagnosis'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Diagnosis Details</button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>

<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Lab Tests
      </div>
      <div id="inner_column">
      <table class="table table-hover">
      {% for labTests in encounter_details.lab %}
          <tr>
            <td>{{ labTests.labId}} {{ labTests.labType}}</td>
          </tr>
      {% endfor %}
      </table>
      </div>
      <div id="inner_column">
        <div class="row form-inline" id='lab_tests'>
        <div class='col-sm form-group'>
            <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
          <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonTests').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                    <input type="text" class="form-control tname" id="test_name" name="test_name" value="" placeholder="Test Name" style="margin:0px 5px 5px 0px">
                `);

                dynamicDiv.appendTo('#dynamicDivContainerTests');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonTests').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>

            <button id="addButtonTests">+</button>
        <button id="removeButtonTests">-</button>
        <div id="dynamicDivContainerTests"></div>

        <button type="submit" class="btn btn-success btn-block has-spinner" name='lab'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Lab Tests</button>
            </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>

<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Radiology Tests & Investigations
      </div>
      <div id="inner_column">
      <table class="table table-hover">
      {% for radiologyTests in encounter_details.radiology %}
          <tr>
            <td>{{ radiologyTests.radiologyProcedureName}} {{ radiologyTests.radiologyCenterType}}</td>
          </tr>
      {% endfor %}

      </table>
      </div>
      <div id="inner_column">
        <div class="row form-inline" id='radiology_tests'>
        <div class='col-sm form-group'>
            <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
          <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonRadiology').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                    <input type="text" class="form-control tname" id="radiology_test_name" name="radiology_test_name" value="" placeholder="Test Name" style="margin:0px 5px 5px 0px">
                `);

                dynamicDiv.appendTo('#dynamicDivContainerRadiology');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonRadiology').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>

            <button id="addButtonRadiology">+</button>
        <button id="removeButtonRadiology">-</button>
        <div id="dynamicDivContainerRadiology"></div>

        <button type="submit" class="btn btn-success btn-block has-spinner" name='radiology'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Radiology Tests</button>
            </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>

<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Prescribe Medicines
      </div>
      <div id="inner_column">
      <table class="table table-hover">
      {% for medicine in encounter_details.pharmacy %}
          <tr>
            <td>
                {{ medicine.drugClassificationCode}} {{ medicine.routeOfAdministration}}<br/>
                {{ medicine.medicationFrequency}} {{ medicine.dose}}
            </td>
          </tr>
      {% endfor %}
      </table>
      </div>
      <div id="inner_column">
        <div class="row form-inline" id='add_medicines'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
          <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonMedicines').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
        <input type="text" class="form-control med_name" id="medi_name" name="med_name" value="" placeholder="Brand Name" style="margin:0px 5px 5px 0px" minlength="4">
        <p>Number of dosage units & Time of consumption<br/>
        (Morning/Afternoon/Evening/Night)<br/></p>
        <input type="number" step="0.5" min=0 value="0" max="999" class="form-control" id="morning" name="morning" style="margin:0px 5px 5px 0px">
        <input type="number" step="0.5" min=0 value="0" max="999" class="form-control" id="afternoon" name="afternoon" style="margin:0px 5px 5px 0px">
        <input type="number" step="0.5" min=0 value="0" max="999" class="form-control" id="evening" name="evening" style="margin:0px 5px 5px 0px">
        <input type="number" step="0.5" min=0 value="0" max="999" class="form-control" id="night" name="night" style="margin:0px 5px 5px 0px">
        <select type="text" class="form-control" id="dosage_unit" value="" placeholder="Dosage Unit" name="dosage_unit" style="margin:0px 5px 5px 0px" ><option value="" disabled selected>Dosage Unit</option><option>TABLET</option><option>CAPSULE</option><option>SPOON</option><option>DROP</option><option>APPLICATION</option><option>PUFF</option><option>UNIT</option><option>PACKET</option><option>SACHET</option></select>
        <select type="text" class="form-control" id="frequency_unit" value="" placeholder="Frequency Unit" name="frequency_unit" style="margin:0px 5px 5px 0px" ><option value="" disabled selected>Frequency Unit</option><option>DAILY</option><option>WEEKLY</option><option>MONTHLY</option><option>SOS</option><option>AS REQUIRED</option><option>ALTERNATE DAYS</option><option>BI WEEKLY</option><option>BI MONTHLY</option></select>
        <input type="number" class="form-control" id="duration" name="duration" value="" placeholder="Duration" style="margin:0px 5px 5px 0px" >
        <select type="text" class="form-control" id="duration_unit" value="" placeholder="Duration Unit" name="duration_unit" style="margin:0px 5px 5px 0px" ><option value="" disabled selected>Duration Unit</option><option>DAYS</option><option>WEEKS</option><option>MONTHS</option><option>AS REQUIRED</option><option>SOS</option></select>
        <select type="text" class="form-control" id="consume_time" name="consume_time" style="margin:0px 5px 5px 0px" ><option value="" disabled selected>When to consume</option><option>BEFORE MEAL</option><option>AFTER MEAL</option><option>As REQUIRED</option><option>SOS</option></select>
        <textarea class="form-control" rows="2" cols="50" id="prescription_notes" placeholder="Prescription Notes" name="prescription_notes" style="margin-bottom:5px"></textarea>
                `);

                dynamicDiv.appendTo('#dynamicDivContainerMedicines');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonMedicines').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>

            <button id="addButtonMedicines">+</button>
        <button id="removeButtonMedicines">-</button>
        <div id="dynamicDivContainerMedicines"></div>

         <button type="submit" class="btn btn-success btn-block has-spinner" name='medicines'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Medicines</button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>

<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Immunization
      </div>
      <div id="inner_column">
      <table class="table table-hover">
      {% for immunization in encounter_details.immunizationOrder %}
          <tr>
            <td>
                {{ immunization.immunizationProductCode}} {{ immunization.immunizationProductDescription}}<br/>
                {{ immunization.immunizationInformationSource}}
            </td>
          </tr>
      {% endfor %}
      </table>
      </div>
      <div id="inner_column">
        <div class="row form-inline" id='add_immunization'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
          <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonImmunization').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                    <input type="text" class="form-control immunizationDescription" id="immunizationDescription" name="immunizationDescription" value="" placeholder="immunization Description" style="margin:0px 5px 5px 0px" minlength="4">
                `);

                dynamicDiv.appendTo('#dynamicDivContainerImmunization');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonImmunization').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>

            <button id="addButtonImmunization">+</button>
        <button id="removeButtonImmunization">-</button>
        <div id="dynamicDivContainerImmunization"></div>

         <button type="submit" class="btn btn-success btn-block has-spinner" name='immunization'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Immunization</button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>

<div class="row" >
<div class="col-sm" id="profile_column">
</div>
    <div class="col-sm" id="profile_column">
      <div id="inner_column" class="alert-success">
        <i class="fa fa-heartbeat" aria-hidden="true">&nbsp;&nbsp;</i>Procedure
      </div>
      <div id="inner_column">
      <table class="table table-hover">
      {% for procedures in encounter_details.procedure %}
          <tr>
            <td>
                {{ procedures.procedureCode}} {{ procedures.procedureName}}<br/>
                {{ procedures.procedureDateTime}} {{ procedures.multipleProcedureFlag}}
            </td>
          </tr>
      {% endfor %}
      </table>
      </div>
      <div id="inner_column">
        <div class="row form-inline" id='add_procedures'>
        <div class='col-sm form-group'>
        <form class="form" action="{% url "opd_consultation" %}" method='post'>
      {% csrf_token %}
          <input type="hidden" name='eId' value="{{encounter_details.encounter.PrimaryKey}}" readonly>
          <input type="hidden" name='prId' value="{{encounter_details.provider.PrimaryKey}}" readonly>
            <script>
                            $(document).ready(function() {
              var counter = 0;

              // Add button click event
              $('#addButtonProcedure').click(function() {
                var dynamicDiv = $('<div>').addClass('ui-widget').attr('id', 'dynamicDiv' + counter);

                // Add the content to the dynamicDiv
                dynamicDiv.append(`
                    <input type="text" class="form-control procedureName" id="procedureName" name="procedureName" value="" placeholder="Procedure Name" style="margin:0px 5px 5px 0px" minlength="4">
                    <div class="input-group date" id="dpk" style="margin-right:10px" data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date-autoclose="true" data-date-container="#dpk">
                    <input type="text" class="form-control" name="procedureDate" placeholder="Date of Procedure" style="margin:0px 0px 5px 0px" required>
                    <div class="input-group-addon" style="margin:0px 0px 5px 0px">
                      <span class="fa fa-calendar"></span>
                    </div>
                  </div>
                `);

                dynamicDiv.appendTo('#dynamicDivContainerProcedure');
                counter++;

                return false; // Prevent default link behavior
              });

              // Remove button click event
              $('#removeButtonProcedure').click(function() {
                if (counter > 0) {
                  $('#dynamicDiv' + (counter - 1)).remove();
                  counter--;
                }
                return false; // Prevent default link behavior
              });
            });

            </script>

            <button id="addButtonProcedure">+</button>
        <button id="removeButtonProcedure">-</button>
        <div id="dynamicDivContainerProcedure"></div>

         <button type="submit" class="btn btn-success btn-block has-spinner" name='procedure'>
      <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>Update Procedures</button>
        </form>
        </div>
        </div>
      </div>
    </div>
<div class="col-sm" id="profile_column">
</div>
</div>

</div>
{% endblock %}
